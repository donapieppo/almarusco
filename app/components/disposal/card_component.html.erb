<div class="dm-card" id="<%= dom_id @disposal %>">
  <% if @modal %>  
    <div class="dm-card-title <%= @disposal.approved? ? 'border-success' : '' %>">
      <div>
        <%= @disposal.disposal_type.to_s %>
        <span class="float-end"><%= @disposal.id %></span>
      </div>
      <div class="small fw-normal">
        <%= @disposal.disposal_type.hp_codes_to_s %>
      </div>
    </div>
  <% else %>
    <%= link_to disposal_path(@disposal, modal: 1), data: { turbo_frame: :modal } do %>  
      <div class="dm-card-title <%= @disposal.approved? ? 'border-success' : '' %>">
        <div>
          <%= @disposal.disposal_type.to_s %>
          <span class="float-end"><%= @disposal.id %></span>
        </div>
        <div class="small fw-normal">
          <%= @disposal.disposal_type.hp_codes_to_s %>
        </div>
      </div>
    <% end %>
  <% end %>
  <div class="dm-card-body">
    <div class="row">
      <div class="col-md-3 fw-bold">
        <%= @disposal.volume %> L. <br/>
        <% if @disposal.kgs %>  
          <%= @disposal.kgs %> Kg. 
        <% else %>
          <span class="text-danger">? Kg</span>
        <% end %>
      </div>
      <div class="col-md-9">
        <%= t :producer %>:
        <%= link_to @disposal.producer, disposals_path(u: @disposal.producer.id) %>
        <% if @disposal.producer_id != @disposal.user_id %>  
          <small>(da <%= link_to @disposal.user, disposals_path(u: @disposal.user_id) %>)</small> 
        <% end %> 
        <div class="text-muted small">
          <%= t :laboratory %> <%= @disposal.lab %><br/>
          <%= t :created_at %> <%= l @disposal.created_at %> <br/>
          <% if @disposal.approved? %>  
            <%= t :approved_at %> <%= l @disposal.approved_at %> <br/>
          <% end %>
          <% if @disposal.legalized? %>  
            <%= t :legalized_at %> <%= l @disposal.legalized_at %> <br/>
          <% end %>
          <% if @disposal.delivered? %>
            <%= t :delivered_at %> <%= l @disposal.delivered_at %> <br/> 
          <% end %>
          <% if @disposal.completed? %>
            <%= t :completed_at %> <%= l @disposal.completed_at %> <br/> 
          <% end %>
          <div class="font-italic text-gray-500">
            <%= @disposal.notes %>  
          </div>
        </div>
      </div>
    </div> <!-- row -->
    <% if @with_details %>  
      <div class="details p-2 small text-info">
        <% if @disposal.disposal_type.un_code %>  
          <strong>un:</strong> <%= @disposal.disposal_type.un_code.name.upcase %><br/>  
        <% end %>
        <strong>cer:</strong> <%= @disposal.disposal_type.cer_code.description.upcase %><br/>
        <strong>stato:</strong> <%= t @disposal.disposal_type.physical_state %>
      </div>
    <% end %>
    <div class="row mt-2">
      <div class="col-md-6">
        <%= render Disposal::StatusComponent.new(@current_user, @disposal, modal: @modal) %>  
      </div>
      <div class="col-md-6">
        <% unless defined?(no_actions) || @disposal.delivered? %>  
          <div class="text-end">
            <%= link_to(fwdmicon('clone', size: 21), [:clone, @disposal], title: 'Crea nuovo rifiuto simile') %>
            <%= link_to(fwdmicon('edit', size: 21), [:edit, @disposal], title: 'Modifica il rifiuto') if @policy.edit? %>  
            <%= helpers.link_to_delete(@disposal) if @policy.destroy? %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div> <!-- dm-card -->
