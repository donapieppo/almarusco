<h1>Gestione strutture</h1>

<div class="info">
  Elenco delle strutture e permessi (in rosso i responsabili).
</div>

<div class="accordion" id="organizations">
  <% @organizations.each do |organization| %>
    <div class="accordion-item">
      <h2 class="accordion-header" id="heading<%= dom_id(organization) %>">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<%= dom_id(organization) %>" aria-expanded="false" aria-controls="collapse<%= dom_id(organization) %>">
          <b><%= organization.code.upcase %></b> <small class="px-2"><%= organization.name %></small>
        </button>
      </h2>
      <div id="collapse<%= dom_id(organization) %>" class="accordion-collapse collapse" aria-labelledby="heading<%= dom_id(organization) %>" data-bs-parent="#organizations">
        <div class="accordion-body">
          <% organization.permissions.each do |p| %>  
            <% color = (p.authlevel > 40) ? 'text-danger' : '' %>  
            <div>
              <span class="<%= color %>"><%= p.user %> (<%= p.authlevel %>)</span>
              <small>(<%= l p.created_at, format: :date_html5 %>)</small>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
